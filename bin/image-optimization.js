#!/usr/bin/env node
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
require("source-map-support/register");
const cdk = require("aws-cdk-lib");
const image_optimization_stack_1 = require("../lib/image-optimization-stack");
const env_1 = require("../env");
function getConfig() {
    const env = app.node.tryGetContext('config');
    if (!env) {
        throw new Error('Context variable missing on CDK command. Pass in as `-c config=XXX`');
    }
    return env === 'prod' ? env_1.prodEnv : env_1.stagingEnv;
}
const app = new cdk.App();
const buildConfig = getConfig();
const stackName = `${buildConfig.stage}-img-transformation-stack`;
new image_optimization_stack_1.ImageOptimizationStack(app, stackName, buildConfig, {
    env: {
        region: buildConfig.awsProfileRegion,
        account: buildConfig.awsAccountId.toString()
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW1hZ2Utb3B0aW1pemF0aW9uLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiaW1hZ2Utb3B0aW1pemF0aW9uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUNBLHVDQUFxQztBQUNyQyxtQ0FBbUM7QUFDbkMsOEVBQXlFO0FBRXpFLGdDQUE2QztBQUU3QyxTQUFTLFNBQVM7SUFDZCxNQUFNLEdBQUcsR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsQ0FBQTtJQUM1QyxJQUFJLENBQUMsR0FBRyxFQUFFO1FBQ1IsTUFBTSxJQUFJLEtBQUssQ0FDYixxRUFBcUUsQ0FDdEUsQ0FBQTtLQUNGO0lBRUQsT0FBTyxHQUFHLEtBQUssTUFBTSxDQUFDLENBQUMsQ0FBQyxhQUFPLENBQUMsQ0FBQyxDQUFDLGdCQUFVLENBQUE7QUFDOUMsQ0FBQztBQUVILE1BQU0sR0FBRyxHQUFHLElBQUksR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDO0FBQzFCLE1BQU0sV0FBVyxHQUFHLFNBQVMsRUFBRSxDQUFBO0FBQy9CLE1BQU0sU0FBUyxHQUFHLEdBQUcsV0FBVyxDQUFDLEtBQUssMkJBQTJCLENBQUE7QUFDakUsSUFBSSxpREFBc0IsQ0FBQyxHQUFHLEVBQUMsU0FBUyxFQUFDLFdBQVcsRUFBTTtJQUN0RCxHQUFHLEVBQUU7UUFDSCxNQUFNLEVBQUUsV0FBVyxDQUFDLGdCQUFnQjtRQUNwQyxPQUFPLEVBQUUsV0FBVyxDQUFDLFlBQVksQ0FBQyxRQUFRLEVBQUU7S0FDN0M7Q0FDRixDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIjIS91c3IvYmluL2VudiBub2RlXHJcbmltcG9ydCAnc291cmNlLW1hcC1zdXBwb3J0L3JlZ2lzdGVyJztcclxuaW1wb3J0ICogYXMgY2RrIGZyb20gJ2F3cy1jZGstbGliJztcclxuaW1wb3J0IHsgSW1hZ2VPcHRpbWl6YXRpb25TdGFjayB9IGZyb20gJy4uL2xpYi9pbWFnZS1vcHRpbWl6YXRpb24tc3RhY2snO1xyXG5pbXBvcnQgeyBCdWlsZENvbmZpZyB9IGZyb20gJy4uL2xpYi9idWlsZC1jb25maWcnO1xyXG5pbXBvcnQgeyBwcm9kRW52LCBzdGFnaW5nRW52IH0gZnJvbSAnLi4vZW52JztcclxuXHJcbmZ1bmN0aW9uIGdldENvbmZpZygpOiBCdWlsZENvbmZpZyB7XHJcbiAgICBjb25zdCBlbnYgPSBhcHAubm9kZS50cnlHZXRDb250ZXh0KCdjb25maWcnKVxyXG4gICAgaWYgKCFlbnYpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgICdDb250ZXh0IHZhcmlhYmxlIG1pc3Npbmcgb24gQ0RLIGNvbW1hbmQuIFBhc3MgaW4gYXMgYC1jIGNvbmZpZz1YWFhgJ1xyXG4gICAgICApXHJcbiAgICB9XHJcbiAgXHJcbiAgICByZXR1cm4gZW52ID09PSAncHJvZCcgPyBwcm9kRW52IDogc3RhZ2luZ0VudlxyXG4gIH1cclxuXHJcbmNvbnN0IGFwcCA9IG5ldyBjZGsuQXBwKCk7XHJcbmNvbnN0IGJ1aWxkQ29uZmlnID0gZ2V0Q29uZmlnKClcclxuY29uc3Qgc3RhY2tOYW1lID0gYCR7YnVpbGRDb25maWcuc3RhZ2V9LWltZy10cmFuc2Zvcm1hdGlvbi1zdGFja2BcclxubmV3IEltYWdlT3B0aW1pemF0aW9uU3RhY2soYXBwLHN0YWNrTmFtZSxidWlsZENvbmZpZywgICAgIHtcclxuICAgIGVudjoge1xyXG4gICAgICByZWdpb246IGJ1aWxkQ29uZmlnLmF3c1Byb2ZpbGVSZWdpb24sXHJcbiAgICAgIGFjY291bnQ6IGJ1aWxkQ29uZmlnLmF3c0FjY291bnRJZC50b1N0cmluZygpXHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4iXX0=